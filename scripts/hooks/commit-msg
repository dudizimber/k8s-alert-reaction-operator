#!/bin/bash

# Commit message hook to enforce conventional commit format
# See: https://www.conventionalcommits.org/

commit_regex='^(feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert)(\(.+\))?: .{1,50}'

error_msg="‚ùå Invalid commit message format!

Please use the conventional commit format:
  <type>[optional scope]: <description>

Examples:
  feat: add webhook server
  fix(controller): resolve memory leak
  docs: update README with examples
  test: add unit tests for matcher
  refactor: simplify alert processing logic
  chore: update dependencies

Valid types: feat, fix, docs, style, refactor, test, chore, perf, ci, build, revert
"

if ! grep -qE "$commit_regex" "$1"; then
    echo "$error_msg" >&2
    exit 1
fi